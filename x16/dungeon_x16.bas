#RetroDevStudio.MetaData.BASIC:2049,BASIC V2 - X16,uppercase,10,10
1 W=8:W2=W+W:W3=W2+W:FD=0:PP=26
2 DEF FN MV(ZZ)=M(PP+V(FD,ZZ))>0
3 PRINT CHR$(27)"5";
9 REM CL=CHECKLIST:RL=RENDERLIST:M=MAP:VL=VIEWLIST
10 DIM CL(3),RL(8),M(63),V(3,21):DATA 1,1,1,1,1,1,1,1, 1,0,0,0,0,0,0,1, 1,1,0,1,0,1,0,1, 1,0,0,0,0,0,0,1
11 DATA 1,0,1,0,1,1,0,1, 1,0,1,0,1,1,0,1, 1,0,0,0,0,1,0,1, 1,1,1,1,1,1,1,1:FOR X=0TO63:READ MV:M(X)=MV:NEXT
12 DIM DC(21,7):FOR X=1TO21:FORY=0TO7:READMV:DC(X,Y)=INT(MV/2):NEXT:NEXT
13 V=-W3-2:V(0,1)=V:FORX=2TO5:V(0,X)=V+(X-1):NEXT
14 V=-W2-2:V(0,6)=V:V(0,7)=V+1:V(0,8)=V+3:V(0,9)=V+4
15 V(0,10)=V+1:V(0,11)=-W2:V(0,12)=V+3
16 V(0,14)=-W-1:V(0,15)=-W+1
17 V(0,17)=-W-1:V(0,18)=-W:V(0,19)=-W+1
19 V(0,20)=-1:V(0,21)=1
20 FORX=1TO21:V(2,X)=V(0,X)*-1:NEXT
23 V(1,1)=-W2+3:FORX=2TO5:V(1,X)=V(1,X-1)+W:NEXT
24 V(1,6)=-W2+2:V(1,7)=V(1,6)+W:V(1,8)=V(1,7)+W2:V(1,9)=V(1,8)+W
25 V(1,10)=V(1,7):V(1,11)=2:V(1,12)=V(1,8)
26 V(1,14)=1-W:V(1,15)=V(1,14)+W2
27 V(1,17)=V(1,14):V(1,18)=+1:V(1,19)=V(1,15)
28 V(1,20)=-W:V(1,21)=W
30 FORX=1TO21:V(3,X)=V(1,X)*-1:NEXT

35 SCREEN $80
36 RECT 0,0,319,239,1

39 GOTO 60
40 GET I$:IF LEN(I$)=0 THEN 40
42 IF ASC(I$)=157 THEN FD=FD-1:IF FD<0 THEN FD=3
43 IF ASC(I$)=29 THEN FD=FD+1:IF FD>3 THEN FD=0
45 IF ASC(I$)=145 THEN GOSUB 4000
46 IF ASC(I$)=17 THEN GOSUB 5000
47 IF I$="Q" THEN 7000
60 S=TI:RX=0
70 CL(0)=20:CL(1)=17:GOSUB1000
80 CL(0)=21:CL(1)=19:GOSUB1000
90 GOSUB 100:REM HERE-CENTER
91 CV=0:GOSUB2000
94 REM PRINT TI-S
95 REM FORX=0TO8:PRINTRL(X);:NEXT:PRINT
96 REM IF FD<3 THEN FD=FD+1:GOTO 60
97 GOSUB 6000:GOTO40
99 END
100 REM HERE-CENTER
110 IF FNMV(18) THEN CV=18:GOSUB2000:RETURN
120 CL(0)=14:CL(1)=10:CL(2)=6:CL(3)=1:GOSUB1000
130 CL(0)=15:CL(1)=12:CL(2)=9:CL(3)=5:GOSUB1000
140 GOSUB 200:REM NEAR-CENTER
150 RETURN
200 REM NEAR-CENTER
210 IF FNMV(11) THEN CV=11:GOSUB2000:RETURN
220 CL(0)=7:CL(1)=2:CL(3)=0:GOSUB1000
230 CL(0)=8:CL(1)=4:GOSUB 1000
240 IF FNMV(3) THEN CV=3:GOSUB2000
250 RETURN
1000 REM CHECK-LISTS
1001 REM PRINT"CHECKING";
1002 REM FORX=0TO3:PRINTCL(X);:NEXT:PRINT
1005 CX=0
1020 REM DO
1025 :CV=CL(CX):RS=FNMV(CV):REM PRINT "CV "CV"="RS
1030 :IF RS THEN GOSUB 2000
1035 :CX=CX+1:IF CX>3 THEN 1050
1040 IF RS>=0 THEN 1020
1050 RETURN
2000 REM ADD VALUE TO RENDERLIST
2005 REM PRINT CV
2010 RL(RX)=CV:RX=RX+1:RETURN
3001 DATA0,156,104,156,104,244,0,244
3002 DATA104,156,248,156,248,244,104,244
3003 DATA248,156, 392,156, 392,244, 248,244
3004 DATA392,156,536,156,536,244,392,244
3005 DATA536,156,639,156,639,244,536,244
3006 DATA0,0,0,0,0,0,0,0
3007 DATA212,134, 248,156, 248,244, 212,266
3008 DATA392,156,428,134,428,266,392,244
3009 DATA0,0,0,0,0,0,0,0
3010 DATA0,134,212,134,212,266,0,266
3011 DATA212,134, 428,134, 428,266, 212,266
3012 DATA428,134,639,134,639,266,428,266
3013 DATA0,0,0,0,0,0,0,0
3014 DATA104,68,212,134,212,266,104,332
3015 DATA532,68,532,332,428,266,428,134
3016 DATA0,0,0,0,0,0,0,0
3017 DATA0,68,104,68,104,332,0,332
3018 DATA104,68,532,68,532,332,104,332
3019 DATA639,68,639,332,532,332,532,68
3020 DATA0,0,104,68,104,332,0,399
3021 DATA639,0,532,68,532,332,639,399
4000 T=PP
4005 IF FD=0 THEN PP=PP-W:GOTO 4050
4010 IF FD=2 THEN PP=PP+W:GOTO 4050
4020 IF FD=1 THEN PP=PP+1:GOTO 4050
4030 IF FD=3 THEN PP=PP-1:GOTO 4050
4050 IF M(PP)>0 THEN PP=T
4060 RETURN
5000 T=PP
5005 IF FD=0 THEN PP=PP+W:GOTO 5050
5010 IF FD=2 THEN PP=PP-W:GOTO 5050
5020 IF FD=1 THEN PP=PP-1:GOTO 5050
5030 IF FD=3 THEN PP=PP+1:GOTO 5050
5050 IF M(PP)>0 THEN PP=T
5060 RETURN

6000 RX=0

6002 RECT 10,10,309,229,0

6005 FOR X=0 TO 2:REM DO
6010  DV=RL(RX):IF DV=0 THEN 6040

6020  LINE DC(DV,0),DC(DV,1),DC(DV,2),DC(DV,3),1
6021  LINE DC(DV,2),DC(DV,3),DC(DV,4),DC(DV,5),1
6022  LINE DC(DV,4),DC(DV,5),DC(DV,6),DC(DV,7),1
6023  LINE DC(DV,6),DC(DV,7),DC(DV,0),DC(DV,1),1

6029  RX=RX+1:X=0
6030 GOTO 6010
6040 RETURN

7000 SCREEN 0
