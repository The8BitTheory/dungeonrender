#RetroDevStudio.MetaData.BASIC:8193,BASIC 65,uppercase,10,10
10 W=8:W2=W+W:W3=W2+W:FD=0:PP=26
20 DEF FN MV(ZZ)=M(PP+V(FD,ZZ))>0
#30 PRINT CHR$(27)"5";
40 REM CL=CHECKLIST:RL=RENDERLIST:M=MAP:VL=VIEWLIST
50 DIM CL(3),RL(8),M(63),V(3,21)

52 DATA 1,1,1,1,1,1,1,1 
54 DATA 1,0,0,0,0,0,0,1
56 DATA 1,1,0,1,0,1,0,1
58 DATA 1,0,0,0,0,0,0,1
60 DATA 1,0,1,0,1,1,0,1
62 DATA 1,0,1,0,1,1,0,1
64 DATA 1,0,0,0,0,1,0,1
65 DATA 1,1,1,1,1,1,1,1


66 FOR X=0 TO 63
67  READ MV
68  M(X)=MV
69 NEXT


70 DIM DC(21,7):FOR X=1TO21:FORY=0TO7:READMV:DC(X,Y)=INT(MV/2):NEXT:NEXT
80 V=-W3-2:V(0,1)=V:FORX=2TO5:V(0,X)=V+(X-1):NEXT
90 V=-W2-2:V(0,6)=V:V(0,7)=V+1:V(0,8)=V+3:V(0,9)=V+4
100 V(0,10)=V+1:V(0,11)=-W2:V(0,12)=V+3
110 V(0,14)=-W-1:V(0,15)=-W+1
120 V(0,17)=-W-1:V(0,18)=-W:V(0,19)=-W+1
130 V(0,20)=-1:V(0,21)=1
140 FORX=1TO21:V(2,X)=V(0,X)*-1:NEXT
150 V(1,1)=-W2+3:FORX=2TO5:V(1,X)=V(1,X-1)+W:NEXT
160 V(1,6)=-W2+2:V(1,7)=V(1,6)+W:V(1,8)=V(1,7)+W2:V(1,9)=V(1,8)+W
170 V(1,10)=V(1,7):V(1,11)=2:V(1,12)=V(1,8)
180 V(1,14)=1-W:V(1,15)=V(1,14)+W2
190 V(1,17)=V(1,14):V(1,18)=+1:V(1,19)=V(1,15)
200 V(1,20)=-W:V(1,21)=W
210 FORX=1TO21:V(3,X)=V(1,X)*-1:NEXT

220 SCREEN 320,200,2
230 SCREEN CLR 1
240 VIEWPORT DEF 11,11,299,179

250 GOTO 320
260 GETKEY I$
270 IF ASC(I$)=157 THEN FD=FD-1:IF FD<0 THEN FD=3
280 IF ASC(I$)=29 THEN FD=FD+1:IF FD>3 THEN FD=0
290 IF ASC(I$)=145 THEN GOSUB 880
300 IF ASC(I$)=17 THEN GOSUB 950
310 IF I$="Q" THEN 1100
320 S=TI:RX=0

330 CL(0)=20:CL(1)=17:CL(2)=13:GOSUB540
340 CL(0)=21:CL(1)=19:CL(2)=16:GOSUB540
350 GOSUB 420:REM HERE-CENTER

360 CV=0:GOSUB640
370 REM PRINT TI-S
380 REM FORX=0TO8:PRINTRL(X);:NEXT:PRINT
390 REM IF FD<3 THEN FD=FD+1:GOTO 60
400 GOSUB 1020:GOTO260
410 END

420 REM HERE-CENTER
430 IF FNMV(18) THEN CV=18:GOSUB640:RETURN
440 CL(0)=14:CL(1)=10:CL(2)=6:CL(3)=1:GOSUB540
450 CL(0)=15:CL(1)=12:CL(2)=9:CL(3)=5:GOSUB540
460 GOSUB 480:REM NEAR-CENTER
470 RETURN
480 REM NEAR-CENTER
490 IF FNMV(11) THEN CV=11:GOSUB640:RETURN
500 CL(0)=7:CL(1)=2:CL(3)=0:GOSUB540
510 CL(0)=8:CL(1)=4:GOSUB 540
520 IF FNMV(3) THEN CV=3:GOSUB640
530 RETURN


540 REM CHECK-LISTS
550 REM PRINT"CHECKING";
560 REM FORX=0TO3:PRINTCL(X);:NEXT:PRINT
570 CX=0
580 DO
590 :CV=CL(CX):RS=FNMV(CV):REM PRINT "CV "CV"="RS
600 :IF RS THEN GOSUB 640
610 :CX=CX+1:IF CX>3 THEN EXIT
620 LOOP WHILE RS>=0
630 RETURN


640 REM ADD VALUE TO RENDERLIST
650 REM PRINT CV
660 RL(RX)=CV:RX=RX+1:RETURN
670 DATA0,156,104,156,104,244,0,244
680 DATA104,156,248,156,248,244,104,244
690 DATA248,156, 392,156, 392,244, 248,244
700 DATA392,156,536,156,536,244,392,244
710 DATA536,156,639,156,639,244,536,244
720 DATA0,0,0,0,0,0,0,0
730 DATA212,134, 248,156, 248,244, 212,266
740 DATA392,156,428,134,428,266,392,244
750 DATA0,0,0,0,0,0,0,0
760 DATA0,134,212,134,212,266,0,266
770 DATA212,134, 428,134, 428,266, 212,266
780 DATA428,134,639,134,639,266,428,266
790 DATA0,0,0,0,0,0,0,0
800 DATA104,68,212,134,212,266,104,332
810 DATA532,68,532,332,428,266,428,134
820 DATA0,0,0,0,0,0,0,0
830 DATA0,68,104,68,104,332,0,332
840 DATA104,68,532,68,532,332,104,332
850 DATA639,68,639,332,532,332,532,68
860 DATA0,0,104,68,104,332,0,399
870 DATA639,0,532,68,532,332,639,399
880 T=PP
890 IF FD=0 THEN PP=PP-W:GOTO 930
900 IF FD=2 THEN PP=PP+W:GOTO 930
910 IF FD=1 THEN PP=PP+1:GOTO 930
920 IF FD=3 THEN PP=PP-1:GOTO 930
930 IF M(PP)>0 THEN PP=T:PRINT CHR$(7)
940 RETURN
950 T=PP
960 IF FD=0 THEN PP=PP+W:GOTO 1000
970 IF FD=2 THEN PP=PP-W:GOTO 1000
980 IF FD=1 THEN PP=PP-1:GOTO 1000
990 IF FD=3 THEN PP=PP+1:GOTO 1000
1000 IF M(PP)>0 THEN PP=T:PRINT CHR$(7)
1010 RETURN

1020 RX=0


1030 PEN0:VIEWPORT CLR:PEN 1

1040 DO
1050  DV=RL(RX):IFDV=0THEN1080

1060  BOX DC(DV,0),DC(DV,1),DC(DV,2),DC(DV,3),DC(DV,4),DC(DV,5),DC(DV,6),DC(DV,7),0

1070  RX=RX+1
1080 LOOP WHILE DV>0
1090 RETURN
1100 SCREEN CLOSE